"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\n\nconst COOKIE_NAME = \"admin_token\";\nfunction getSecret() {\n    const secret = process.env.JWT_SECRET ?? \"fallback-secret\";\n    return new TextEncoder().encode(secret);\n}\nasync function middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Propagar header x-is-admin para o root layout suprimir Header/Footer do site\n    const requestHeaders = new Headers(request.headers);\n    if (pathname.startsWith(\"/admin\") || pathname.startsWith(\"/styleguide\")) {\n        requestHeaders.set(\"x-is-admin\", \"1\");\n    }\n    // Styleguide — sem autenticação necessária\n    if (pathname.startsWith(\"/styleguide\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    }\n    // Permitir acesso à página e API de login sem autenticação\n    const publicPaths = [\n        \"/admin/login\",\n        \"/api/admin/auth/login\",\n        \"/api/admin/dev-credentials\"\n    ];\n    if (publicPaths.includes(pathname)) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    }\n    // Verificar token para todas as outras rotas /admin/* e /api/admin/*\n    const token = request.cookies.get(COOKIE_NAME)?.value;\n    if (!token) {\n        // Página admin → redireciona para login\n        if (pathname.startsWith(\"/admin\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        // API admin → retorna 401\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"N\\xe3o autorizado\"\n        }, {\n            status: 401\n        });\n    }\n    try {\n        await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, getSecret());\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    } catch  {\n        if (pathname.startsWith(\"/admin\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Token inv\\xe1lido\"\n        }, {\n            status: 401\n        });\n    }\n}\nconst config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/api/admin/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXdEO0FBQ3ZCO0FBRWpDLE1BQU1FLGNBQWM7QUFFcEIsU0FBU0M7SUFDUCxNQUFNQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLFVBQVUsSUFBSTtJQUN6QyxPQUFPLElBQUlDLGNBQWNDLE1BQU0sQ0FBQ0w7QUFDbEM7QUFFTyxlQUFlTSxXQUFXQyxPQUFvQjtJQUNuRCxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxRQUFRRSxPQUFPO0lBRXBDLCtFQUErRTtJQUMvRSxNQUFNQyxpQkFBaUIsSUFBSUMsUUFBUUosUUFBUUssT0FBTztJQUNsRCxJQUFJSixTQUFTSyxVQUFVLENBQUMsYUFBYUwsU0FBU0ssVUFBVSxDQUFDLGdCQUFnQjtRQUN2RUgsZUFBZUksR0FBRyxDQUFDLGNBQWM7SUFDbkM7SUFFQSwyQ0FBMkM7SUFDM0MsSUFBSU4sU0FBU0ssVUFBVSxDQUFDLGdCQUFnQjtRQUN0QyxPQUFPakIscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFO0lBRUEsMkRBQTJEO0lBQzNELE1BQU1NLGNBQWM7UUFDbEI7UUFDQTtRQUNBO0tBQ0Q7SUFDRCxJQUFJQSxZQUFZQyxRQUFRLENBQUNULFdBQVc7UUFDbEMsT0FBT1oscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFO0lBRUEscUVBQXFFO0lBQ3JFLE1BQU1RLFFBQVFYLFFBQVFZLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDdEIsY0FBY3VCO0lBRWhELElBQUksQ0FBQ0gsT0FBTztRQUNWLHdDQUF3QztRQUN4QyxJQUFJVixTQUFTSyxVQUFVLENBQUMsV0FBVztZQUNqQyxPQUFPakIscURBQVlBLENBQUMwQixRQUFRLENBQUMsSUFBSUMsSUFBSSxnQkFBZ0JoQixRQUFRaUIsR0FBRztRQUNsRTtRQUNBLDBCQUEwQjtRQUMxQixPQUFPNUIscURBQVlBLENBQUM2QixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFpQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUN0RTtJQUVBLElBQUk7UUFDRixNQUFNOUIsK0NBQVNBLENBQUNxQixPQUFPbkI7UUFDdkIsT0FBT0gscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFLEVBQUUsT0FBTTtRQUNOLElBQUlGLFNBQVNLLFVBQVUsQ0FBQyxXQUFXO1lBQ2pDLE9BQU9qQixxREFBWUEsQ0FBQzBCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGdCQUFnQmhCLFFBQVFpQixHQUFHO1FBQ2xFO1FBQ0EsT0FBTzVCLHFEQUFZQSxDQUFDNkIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBaUIsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDdEU7QUFDRjtBQUVPLE1BQU1DLFNBQVM7SUFDcEJDLFNBQVM7UUFBQztRQUFpQjtLQUFvQjtBQUNqRCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL21pZGRsZXdhcmUudHM/NDIyZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCI7XG5pbXBvcnQgeyBqd3RWZXJpZnkgfSBmcm9tIFwiam9zZVwiO1xuXG5jb25zdCBDT09LSUVfTkFNRSA9IFwiYWRtaW5fdG9rZW5cIjtcblxuZnVuY3Rpb24gZ2V0U2VjcmV0KCk6IFVpbnQ4QXJyYXkge1xuICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5KV1RfU0VDUkVUID8/IFwiZmFsbGJhY2stc2VjcmV0XCI7XG4gIHJldHVybiBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0KTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxdWVzdC5uZXh0VXJsO1xuXG4gIC8vIFByb3BhZ2FyIGhlYWRlciB4LWlzLWFkbWluIHBhcmEgbyByb290IGxheW91dCBzdXByaW1pciBIZWFkZXIvRm9vdGVyIGRvIHNpdGVcbiAgY29uc3QgcmVxdWVzdEhlYWRlcnMgPSBuZXcgSGVhZGVycyhyZXF1ZXN0LmhlYWRlcnMpO1xuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hZG1pblwiKSB8fCBwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0eWxlZ3VpZGVcIikpIHtcbiAgICByZXF1ZXN0SGVhZGVycy5zZXQoXCJ4LWlzLWFkbWluXCIsIFwiMVwiKTtcbiAgfVxuXG4gIC8vIFN0eWxlZ3VpZGUg4oCUIHNlbSBhdXRlbnRpY2HDp8OjbyBuZWNlc3PDoXJpYVxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9zdHlsZWd1aWRlXCIpKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KHsgcmVxdWVzdDogeyBoZWFkZXJzOiByZXF1ZXN0SGVhZGVycyB9IH0pO1xuICB9XG5cbiAgLy8gUGVybWl0aXIgYWNlc3NvIMOgIHDDoWdpbmEgZSBBUEkgZGUgbG9naW4gc2VtIGF1dGVudGljYcOnw6NvXG4gIGNvbnN0IHB1YmxpY1BhdGhzID0gW1xuICAgIFwiL2FkbWluL2xvZ2luXCIsXG4gICAgXCIvYXBpL2FkbWluL2F1dGgvbG9naW5cIixcbiAgICBcIi9hcGkvYWRtaW4vZGV2LWNyZWRlbnRpYWxzXCIsIC8vIERFViBvbmx5IOKAlCBibG9xdWVhZG8gZW0gcHJvZHXDp8OjbyBubyBwcsOzcHJpbyBoYW5kbGVyXG4gIF07XG4gIGlmIChwdWJsaWNQYXRocy5pbmNsdWRlcyhwYXRobmFtZSkpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoeyByZXF1ZXN0OiB7IGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0gfSk7XG4gIH1cblxuICAvLyBWZXJpZmljYXIgdG9rZW4gcGFyYSB0b2RhcyBhcyBvdXRyYXMgcm90YXMgL2FkbWluLyogZSAvYXBpL2FkbWluLypcbiAgY29uc3QgdG9rZW4gPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KENPT0tJRV9OQU1FKT8udmFsdWU7XG5cbiAgaWYgKCF0b2tlbikge1xuICAgIC8vIFDDoWdpbmEgYWRtaW4g4oaSIHJlZGlyZWNpb25hIHBhcmEgbG9naW5cbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hZG1pblwiKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL2FkbWluL2xvZ2luXCIsIHJlcXVlc3QudXJsKSk7XG4gICAgfVxuICAgIC8vIEFQSSBhZG1pbiDihpIgcmV0b3JuYSA0MDFcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJOw6NvIGF1dG9yaXphZG9cIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIGdldFNlY3JldCgpKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoeyByZXF1ZXN0OiB7IGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0gfSk7XG4gIH0gY2F0Y2gge1xuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FkbWluXCIpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvYWRtaW4vbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiVG9rZW4gaW52w6FsaWRvXCIgfSwgeyBzdGF0dXM6IDQwMSB9KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBtYXRjaGVyOiBbXCIvYWRtaW4vOnBhdGgqXCIsIFwiL2FwaS9hZG1pbi86cGF0aCpcIl0sXG59O1xuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImp3dFZlcmlmeSIsIkNPT0tJRV9OQU1FIiwiZ2V0U2VjcmV0Iiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicGF0aG5hbWUiLCJuZXh0VXJsIiwicmVxdWVzdEhlYWRlcnMiLCJIZWFkZXJzIiwiaGVhZGVycyIsInN0YXJ0c1dpdGgiLCJzZXQiLCJuZXh0IiwicHVibGljUGF0aHMiLCJpbmNsdWRlcyIsInRva2VuIiwiY29va2llcyIsImdldCIsInZhbHVlIiwicmVkaXJlY3QiLCJVUkwiLCJ1cmwiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});