"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/webapi/jwt/verify.js\");\n\n\nconst COOKIE_NAME = \"admin_token\";\nfunction getSecret() {\n    const secret = process.env.JWT_SECRET ?? \"fallback-secret\";\n    return new TextEncoder().encode(secret);\n}\nasync function middleware(request) {\n    const { pathname } = request.nextUrl;\n    // Propagar header x-is-admin para o root layout suprimir Header/Footer do site\n    const requestHeaders = new Headers(request.headers);\n    if (pathname.startsWith(\"/admin\") || pathname.startsWith(\"/styleguide\")) {\n        requestHeaders.set(\"x-is-admin\", \"1\");\n    }\n    // Styleguide — sem autenticação necessária\n    if (pathname.startsWith(\"/styleguide\")) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    }\n    // Permitir acesso à página e API de login sem autenticação\n    const publicPaths = [\n        \"/admin/login\",\n        \"/api/admin/auth/login\",\n        \"/api/admin/dev-credentials\"\n    ];\n    if (publicPaths.includes(pathname)) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    }\n    // Verificar token para todas as outras rotas /admin/* e /api/admin/*\n    const token = request.cookies.get(COOKIE_NAME)?.value;\n    if (!token) {\n        // Página admin → redireciona para login\n        if (pathname.startsWith(\"/admin\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        // API admin → retorna 401\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"N\\xe3o autorizado\"\n        }, {\n            status: 401\n        });\n    }\n    try {\n        await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(token, getSecret());\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n            request: {\n                headers: requestHeaders\n            }\n        });\n    } catch  {\n        if (pathname.startsWith(\"/admin\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/login\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Token inv\\xe1lido\"\n        }, {\n            status: 401\n        });\n    }\n}\nconst config = {\n    matcher: [\n        \"/admin/:path*\",\n        \"/api/admin/:path*\",\n        \"/styleguide\",\n        \"/styleguide/:path*\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXdEO0FBQ3ZCO0FBRWpDLE1BQU1FLGNBQWM7QUFFcEIsU0FBU0M7SUFDUCxNQUFNQyxTQUFTQyxRQUFRQyxHQUFHLENBQUNDLFVBQVUsSUFBSTtJQUN6QyxPQUFPLElBQUlDLGNBQWNDLE1BQU0sQ0FBQ0w7QUFDbEM7QUFFTyxlQUFlTSxXQUFXQyxPQUFvQjtJQUNuRCxNQUFNLEVBQUVDLFFBQVEsRUFBRSxHQUFHRCxRQUFRRSxPQUFPO0lBRXBDLCtFQUErRTtJQUMvRSxNQUFNQyxpQkFBaUIsSUFBSUMsUUFBUUosUUFBUUssT0FBTztJQUNsRCxJQUFJSixTQUFTSyxVQUFVLENBQUMsYUFBYUwsU0FBU0ssVUFBVSxDQUFDLGdCQUFnQjtRQUN2RUgsZUFBZUksR0FBRyxDQUFDLGNBQWM7SUFDbkM7SUFFQSwyQ0FBMkM7SUFDM0MsSUFBSU4sU0FBU0ssVUFBVSxDQUFDLGdCQUFnQjtRQUN0QyxPQUFPakIscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFO0lBRUEsMkRBQTJEO0lBQzNELE1BQU1NLGNBQWM7UUFDbEI7UUFDQTtRQUNBO0tBQ0Q7SUFDRCxJQUFJQSxZQUFZQyxRQUFRLENBQUNULFdBQVc7UUFDbEMsT0FBT1oscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFO0lBRUEscUVBQXFFO0lBQ3JFLE1BQU1RLFFBQVFYLFFBQVFZLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDdEIsY0FBY3VCO0lBRWhELElBQUksQ0FBQ0gsT0FBTztRQUNWLHdDQUF3QztRQUN4QyxJQUFJVixTQUFTSyxVQUFVLENBQUMsV0FBVztZQUNqQyxPQUFPakIscURBQVlBLENBQUMwQixRQUFRLENBQUMsSUFBSUMsSUFBSSxnQkFBZ0JoQixRQUFRaUIsR0FBRztRQUNsRTtRQUNBLDBCQUEwQjtRQUMxQixPQUFPNUIscURBQVlBLENBQUM2QixJQUFJLENBQUM7WUFBRUMsT0FBTztRQUFpQixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUN0RTtJQUVBLElBQUk7UUFDRixNQUFNOUIsK0NBQVNBLENBQUNxQixPQUFPbkI7UUFDdkIsT0FBT0gscURBQVlBLENBQUNtQixJQUFJLENBQUM7WUFBRVIsU0FBUztnQkFBRUssU0FBU0Y7WUFBZTtRQUFFO0lBQ2xFLEVBQUUsT0FBTTtRQUNOLElBQUlGLFNBQVNLLFVBQVUsQ0FBQyxXQUFXO1lBQ2pDLE9BQU9qQixxREFBWUEsQ0FBQzBCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLGdCQUFnQmhCLFFBQVFpQixHQUFHO1FBQ2xFO1FBQ0EsT0FBTzVCLHFEQUFZQSxDQUFDNkIsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBaUIsR0FBRztZQUFFQyxRQUFRO1FBQUk7SUFDdEU7QUFDRjtBQUVPLE1BQU1DLFNBQVM7SUFDcEJDLFNBQVM7UUFBQztRQUFpQjtRQUFxQjtRQUFlO0tBQXFCO0FBQ3RGLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbWlkZGxld2FyZS50cz80MjJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IGp3dFZlcmlmeSB9IGZyb20gXCJqb3NlXCI7XG5cbmNvbnN0IENPT0tJRV9OQU1FID0gXCJhZG1pbl90b2tlblwiO1xuXG5mdW5jdGlvbiBnZXRTZWNyZXQoKTogVWludDhBcnJheSB7XG4gIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQgPz8gXCJmYWxsYmFjay1zZWNyZXRcIjtcbiAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzZWNyZXQpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSByZXF1ZXN0Lm5leHRVcmw7XG5cbiAgLy8gUHJvcGFnYXIgaGVhZGVyIHgtaXMtYWRtaW4gcGFyYSBvIHJvb3QgbGF5b3V0IHN1cHJpbWlyIEhlYWRlci9Gb290ZXIgZG8gc2l0ZVxuICBjb25zdCByZXF1ZXN0SGVhZGVycyA9IG5ldyBIZWFkZXJzKHJlcXVlc3QuaGVhZGVycyk7XG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FkbWluXCIpIHx8IHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvc3R5bGVndWlkZVwiKSkge1xuICAgIHJlcXVlc3RIZWFkZXJzLnNldChcIngtaXMtYWRtaW5cIiwgXCIxXCIpO1xuICB9XG5cbiAgLy8gU3R5bGVndWlkZSDigJQgc2VtIGF1dGVudGljYcOnw6NvIG5lY2Vzc8OhcmlhXG4gIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL3N0eWxlZ3VpZGVcIikpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoeyByZXF1ZXN0OiB7IGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0gfSk7XG4gIH1cblxuICAvLyBQZXJtaXRpciBhY2Vzc28gw6AgcMOhZ2luYSBlIEFQSSBkZSBsb2dpbiBzZW0gYXV0ZW50aWNhw6fDo29cbiAgY29uc3QgcHVibGljUGF0aHMgPSBbXG4gICAgXCIvYWRtaW4vbG9naW5cIixcbiAgICBcIi9hcGkvYWRtaW4vYXV0aC9sb2dpblwiLFxuICAgIFwiL2FwaS9hZG1pbi9kZXYtY3JlZGVudGlhbHNcIiwgLy8gREVWIG9ubHkg4oCUIGJsb3F1ZWFkbyBlbSBwcm9kdcOnw6NvIG5vIHByw7NwcmlvIGhhbmRsZXJcbiAgXTtcbiAgaWYgKHB1YmxpY1BhdGhzLmluY2x1ZGVzKHBhdGhuYW1lKSkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCh7IHJlcXVlc3Q6IHsgaGVhZGVyczogcmVxdWVzdEhlYWRlcnMgfSB9KTtcbiAgfVxuXG4gIC8vIFZlcmlmaWNhciB0b2tlbiBwYXJhIHRvZGFzIGFzIG91dHJhcyByb3RhcyAvYWRtaW4vKiBlIC9hcGkvYWRtaW4vKlxuICBjb25zdCB0b2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoQ09PS0lFX05BTUUpPy52YWx1ZTtcblxuICBpZiAoIXRva2VuKSB7XG4gICAgLy8gUMOhZ2luYSBhZG1pbiDihpIgcmVkaXJlY2lvbmEgcGFyYSBsb2dpblxuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKFwiL2FkbWluXCIpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvYWRtaW4vbG9naW5cIiwgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgLy8gQVBJIGFkbWluIOKGkiByZXRvcm5hIDQwMVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIk7Do28gYXV0b3JpemFkb1wiIH0sIHsgc3RhdHVzOiA0MDEgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGF3YWl0IGp3dFZlcmlmeSh0b2tlbiwgZ2V0U2VjcmV0KCkpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCh7IHJlcXVlc3Q6IHsgaGVhZGVyczogcmVxdWVzdEhlYWRlcnMgfSB9KTtcbiAgfSBjYXRjaCB7XG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvYWRtaW5cIikpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9hZG1pbi9sb2dpblwiLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogXCJUb2tlbiBpbnbDoWxpZG9cIiB9LCB7IHN0YXR1czogNDAxIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcIi9hZG1pbi86cGF0aCpcIiwgXCIvYXBpL2FkbWluLzpwYXRoKlwiLCBcIi9zdHlsZWd1aWRlXCIsIFwiL3N0eWxlZ3VpZGUvOnBhdGgqXCJdLFxufTtcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJqd3RWZXJpZnkiLCJDT09LSUVfTkFNRSIsImdldFNlY3JldCIsInNlY3JldCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiVGV4dEVuY29kZXIiLCJlbmNvZGUiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsInBhdGhuYW1lIiwibmV4dFVybCIsInJlcXVlc3RIZWFkZXJzIiwiSGVhZGVycyIsImhlYWRlcnMiLCJzdGFydHNXaXRoIiwic2V0IiwibmV4dCIsInB1YmxpY1BhdGhzIiwiaW5jbHVkZXMiLCJ0b2tlbiIsImNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiY29uZmlnIiwibWF0Y2hlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});